"use strict";angular.module("barbod",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/login.tpl.html",controller:"LoginCtrl"}).when("/dashboard",{templateUrl:"views/main-dashboard.tpl.html",controller:"mainDashboardCtrl"}).when("/dashboard/modules",{templateUrl:"views/dashboard.tpl.html",controller:"DashboardCtrl"})}]);var barbod=angular.module("barbod");barbod.controller("DashboardCtrl",["$scope","$http","$templateRequest","$compile","APIService",function(a,b,c,d,e){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.get("calls.json").success(function(b){void 0==a.callConfig&&null===a.callConfig||(a.callConfig=b)}),$(".in-login-bg").removeClass("in-login-bg"),$(".dropdown").dropdown({transition:"drop"}),console.log("DashbaordCtrl is ready"),a.mouseoverInfo=function(){$(".brand-edit-each").popup({position:"top center"})},a.mainData="",a.showColumn={},a.typeControl={},a.messageHandler="test",a.dataTableRequester=function(b,c){$("#"+b).append('<div class="ui active inverted dimmer"><div class="ui medium text loader">Loading</div></div>');var d={advanceSearch:[{key:"",value:""}]},f={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",rowIndex:c,rowSize:7,orderColumn:"code",orderType:"desc",searchKeyword:"",advanceSearch:JSON.stringify(d)},g="http://service.webbels.net/brand/paginate",h="GET";e.doApiCall(f,g,h,function(c){if("true"!==c.success)$("#"+b+" .loader").hide().parent().append('<i class="huge icons">                                      <i class="big red warning circle icon"></i>                                      <i class="black setting loading icon"></i>                                    </i><br>                                    <button class="ui big compact labeled red icon button">                                      <i class="retweet icon"></i>                                      Retry ?                                    </button>');else{a.mainData=c.GD,a.pagination=c.GD.pagecount,a.pageNumbers=[];for(var d=0;d<a.pagination;d++)a.pageNumbers.push(+d+1);$("#"+b).children(".inverted.dimmer").remove()}a.messageHandler=c.Message})},a.validation=function(b){a.validation={};var c={brandCode:a.validation.brandCode,brandDescription:a.validation.brandDescription,brandActive:a.validation.brandActive};return c},a.brandAdding=function(){var c=angular.copy(a.brand);c.userId="169055BD-24D6-4E10-9F98-D4A8C6E102C5",c.browserInfo="Chrome Carany",c.companyId="",c.isActive=1,c.isDeleted=0,c.sessionId="",b({url:"http://service.webbels.net/brand/save/",method:"GET",params:c}).then(function(b){a.dataTableRequester("brandModule",1)}),a.closeOverSlider()},a.brandDelete=function(){var c=[];angular.forEach(a.gridCheckBox,function(a,b){c.push(b)});var d=c.length,e={};e.userId="169055BD-24D6-4E10-9F98-D4A8C6E102C5",e.browserInfo="Chrome Carany",e.ids=c,e.sessionId="",b({url:"http://service.webbels.net/brand/delete/",method:"GET",params:e}).then(function(b){a.gridCheckBox={},a.dataTableRequester("brandModule",1)}),a.closeOverSlider();for(var f=0;d>f;f++)$("[module-id]").prop("checked",!1)},a.moduleList=JSON.parse(localStorage.getItem("structedAccess")),a.moduleToggler=function(b){a.unparsedName=b;var c=b.toLowerCase().replace(" ","");a.page=c},a.dropdown={},a.dropdownQuery=function(b){var c=a.callConfig.endpoint.methods[1],d={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"",browserInfo:"chrome canary"},f="http://service.webbels.net/supplier/getall";e.doApiCall(d,f,c,function(b){a.dropdown=b.GD.data})},a.templateRequester=function(b,e){c("views/"+b+".tpl.html").then(function(b){var c=angular.element(b);$("#"+e).html(c),d(c.contents())(a),$(".brand-edit-each").popup({position:"top center"})})},a.closeOverSlider=function(){$(".over-slider").toggleClass("hide-over-slider")},a.showItems=function(a){$(".items-list-"+a).toggleClass("hide")},a.spotlight=function(){$(".global-spotlight").dimmer("show")},a.moduleSlider=function(a){var b=$(".module-container").outerWidth();$(".slide-buttons li").removeClass("current"),$(".slide-buttons li:eq("+a+")").addClass("current"),$(".scroller").animate({scrollLeft:a*b},1e3)},a.gridCheckBox={},a.gridCheckBoxCounter=0,a.gridCheckBoxStatus=function(b,c,d,e){$('[module-id="'+b+'"]').is(":checked")?(a.gridCheckBoxCounter++,a.gridCheckBox[b]={id:b,description:d,active:c,name:e}):(delete a.gridCheckBox[b],a.gridCheckBoxCounter--)},a.gridCheckBoxStatusRemover=function(b){delete a.gridCheckBox[b]},a.checkAll=function(){$("[module-id]").trigger("click")}}]),barbod.directive("brandTable",function(){return{restrict:"AE",templateUrl:"views/brandtable.tpl.html"}}),barbod.directive("companyModule",function(){return{restrict:"AE",templateUrl:"views/companymodule.tpl.html"}}),barbod.directive("itemtypeModule",function(){return{restrict:"AE",templateUrl:"views/itemtypemodule.tpl.html"}}),barbod.directive("supplierModule",function(){return{restrict:"AE",templateUrl:"views/suppliermodule.tpl.html"}}),barbod.directive("itemModule",function(){return{restrict:"AE",templateUrl:"views/itemmodule.tpl.html"}}),barbod.directive("measurementModule",function(){return{restrict:"AE",templateUrl:"views/measurementmodule.tpl.html"}}),barbod.directive("purchaseorderModule",function(){return{restrict:"AE",templateUrl:"views/purchaseordermodule.tpl.html"}}),barbod.directive("genericOverSlider",function(){return{restrict:"AE",templateUrl:"views/overslider.tpl.html"}}),barbod.controller("measurementModuleController",["$scope","APIService","$http",function(a,b,c){a.barbod={},a.pageCount=[],a.barbod.measurement={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",id:"",code:"",description:"",companyId:"",isActive:1,isDeleted:0},a.initData=function(d){c.get("calls.json").success(function(c){a.calls=c;var e=c.endpoint.main+c.controllers[4]+c.endpoint.paginate,f=c.endpoint.methods[1],g={userId:c["function"]["public"].userId,sessionId:"",browserInfo:"Chrome Canary",rowIndex:d,rowSize:3,orderColumn:"code",orderType:"asc",searchKeyword:"",advanceSearch:""},h="moduleDimmer";$("#"+h).addClass("active"),b.doApiCall(g,e,f,function(b){a.tableData=b,console.log(a.tableData.GD.rowsperpage),a.initPageCount(a.tableData.GD),$("#"+h).removeClass("active")})})},a.initPageCount=function(b){a.pageCount=[];for(var c=0;c<b.pagecount;c++)a.pageCount.push(c)},a.initData(1)}]),barbod.controller("itemModuleController",["$scope","APIService","$http",function(a,b,c){a.barbod={},a.barbod.item={},a.barbod.item.itemcode="",a.barbod.item.itemdescription="",a.barbod.item.itembarcode="",c.get("calls.json").success(function(c){var d=c.endpoint.main+c.controllers[0]+c.endpoint.paginate,e=c.endpoint.methods[1],f={userId:c["function"]["public"].userId,sessionId:"",browserInfo:"Chrome Canary"};b.doApiCall(f,d,e,function(b){a.tableData=b})}),$(".dropdown").dropdown({transition:"drop"}),a.configModal=function(){$(".ui.basic.modal").modal("show")},a.itemAdd=function(){}}]),barbod.controller("brandModuleController",["$scope","APIService","$http",function(a,b,c){a.barbod={customize:{tableRowSize:10},brand:{userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",id:"",code:"testcode",description:"",companyId:"",isActive:1,isDeleted:0,configModal:!1}},a.pageCount=[],a.barbod.brand.stepper=[{title:"Code",description:"Write your brand code",icon:"qrcode"},{title:"Description",description:"Write your brand description",icon:"browser"}],a.initData=function(d){c.get("calls.json").success(function(c){a.calls=c;var e=c.endpoint.main+c.controllers[0]+c.endpoint.paginate,f=c.endpoint.methods[1],g={userId:c["function"]["public"].userId,sessionId:"",browserInfo:"Chrome Canary",rowIndex:d,rowSize:a.barbod.customize.tableRowSize,orderColumn:"code",orderType:"asc",searchKeyword:"",advanceSearch:""},h="moduleDimmer";$("#"+h).addClass("active"),b.doApiCall(g,e,f,function(b){a.tableData=b,a.initPageCount(a.tableData.GD),$("#"+h).removeClass("active")})})},a.initPageCount=function(b){a.pageCount=[];for(var c=0;c<b.pagecount;c++)a.pageCount.push(c)},a.initData(1),$(".dropdown").dropdown({transition:"drop"}),a.addNewBrand=function(){var c=a.barbod.brand,d=a.calls.endpoint.main+a.calls.controllers[0]+a.calls.endpoint.save,e=a.calls.endpoint.methods[1];b.doApiCall(c,d,e,function(b){a.showSuccessMessage=!0,a.overSlider(),a.initData(a.tableData.GD.currentpage)})},a.DeleteBrands=function(){delete a.editList.list;var c=[];angular.forEach(a.editList,function(a,b){c.push(b)});var d={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",ids:c},e=a.calls.endpoint.main+a.calls.controllers[0]+a.calls.endpoint["delete"],f=a.calls.endpoint.methods[1];b.doApiCall(d,e,f,function(b){a.showSuccessMessage=!0,a.overSlider(),a.initData(a.tableData.GD.currentpage)})},a.closeBrandOverSlider=function(){a.showHideValidation=!1},a.codeValidation=function(){var b=a.barbod.brand.code,c=b.length,d=parseInt(b).toString().length;return c===d},a.descValidation=function(a){}}]),barbod.controller("companyModuleController",["$scope","APIService","$http",function(a,b,c){a.barbod={},a.barbod.company={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",id:"842CB376-25D4-41B9-B1B6-1055F1306762"},a.barbod.company.dataInput={parent:{id:"",name:"",description:"",companyId:"",isActive:"1",isDeleted:"0"},child:[{id:"",templateId:"E67FAA2F-7A5A-4E09-A6FB-EE0CC8E64F8E",label:"Contact Person",value:""},{id:"",templateId:"B5614042-F6B6-4489-ABFB-E55D79089F66",label:"Contact No.",value:""},{id:"",templateId:"8F75C6F4-CF72-487C-ACAD-7DCAE5F22A07",label:"Address",value:""}]},a.companyEditMode=!1,a.initData=function(d){c.get("calls.json").success(function(c){a.calls=c;var d=c.endpoint.main+c.controllers[2]+c.endpoint.getbyid,e=c.endpoint.methods[1],f={userId:c["function"]["public"].userId,sessionId:"",browserInfo:"Chrome Canary",id:a.barbod.company.id},g="moduleDimmer";$("#"+g).addClass("active"),b.doApiCall(f,d,e,function(b){a.tableData=b.FM.body,a.barbod.company.dataInput.parent.id=a.tableData[0].displayname,$("#"+g).removeClass("active")})})},a.initData(),a.updateCompany=function(){var c=a.calls,d={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",dataToken:JSON.stringify(a.barbod.company.dataInput)},e=c.endpoint.main+c.controllers[2]+c.endpoint.save,f=c.endpoint.methods[1];b.doApiCall(d,e,f,function(b){a.initData()})}}]),barbod.controller("supplierModuleController",["$scope","APIService","$http",function(a,b,c){a.barbod={},a.barbod.customize={tableRowSize:10},a.pageCount=[],a.barbod.supplier={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"",browserInfo:"chrome canary",id:"",code:"",description:"",companyId:"",isActive:1,isDeleted:0,dataToken:""},a.barbod.supplier.dataInput={parent:{id:"CB55FDEE-D4A9-47EC-94A1-DFB6AD408D44",code:"companyxxa",description:"company xx one",companyId:"",isTaxable:1,isActive:1,isDeleted:"0"},child:[{id:"",templateId:"E67FAA2F-7A5A-4E09-A6FB-EE0CC8E64F8E",label:"Contact Person",value:""},{id:"",templateId:"8F75C6F4-CF72-487C-ACAD-7DCAE5F22A07",label:"Address",value:""},{id:"3755DAEC-FCB7-4F13-9BE4-C3F9596A2CC8",templateId:"B5614042-F6B6-4489-ABFB-E55D79089F66",label:"Contact No.",value:""}]},a.initData=function(d){c.get("calls.json").success(function(c){a.calls=c;var e=c.endpoint.main+c.controllers[1]+c.endpoint.paginate,f=c.endpoint.methods[1],g={userId:c["function"]["public"].userId,sessionId:"",browserInfo:"Chrome Canary",rowIndex:d,rowSize:a.barbod.customize.tableRowSize,orderColumn:"code",orderType:"asc",searchKeyword:"",advanceSearch:""},h="moduleDimmer";$("#"+h).addClass("active"),b.doApiCall(g,e,f,function(b){a.tableData=b,a.initPageCount(a.tableData.GD),$("#"+h).removeClass("active")})})},a.initPageCount=function(b){a.pageCount=[];for(var c=0;c<b.pagecount;c++)a.pageCount.push(c)},a.initData(1),a.supplierDelete=function(){},a.addNewSupplier=function(){a.barbod.supplier.dataToken=JSON.stringify(a.barbod.supplier.dataInput);var c=a.barbod.supplier,d=a.calls.endpoint.main+a.calls.controllers[1]+a.calls.endpoint.save,e=a.calls.endpoint.methods[1];b.doApiCall(c,d,e,function(b){a.showSuccessMessage=!0,a.overSlider(),a.initData(a.tableData.GD.currentpage)})}}]),barbod.controller("itemtypeModuleController",["$scope","APIService","$http",function(a,b,c){a.barbod={},a.barbod.customize={tableRowSize:10},a.pageCount=[],a.barbod.itemtype={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",id:"",code:"",description:"",companyId:"",isActive:1,isDeleted:0},a.initData=function(d){c.get("calls.json").success(function(c){a.calls=c;var e=c.endpoint.main+c.controllers[3]+c.endpoint.paginate,f=c.endpoint.methods[1],g={userId:c["function"]["public"].userId,sessionId:"",browserInfo:"Chrome Canary",rowIndex:d,rowSize:a.barbod.customize.tableRowSize,orderColumn:"code",orderType:"asc",searchKeyword:"",advanceSearch:""};b.doApiCall(g,e,f,function(b){a.tableData=b,a.initPageCount(a.tableData.GD)})})},a.initPageCount=function(b){a.pageCount=[];for(var c=0;c<b.pagecount;c++)a.pageCount.push(c)},a.initData(1),a.addNewItemType=function(){var c=a.barbod.itemtype,d=a.calls.endpoint.main+a.calls.controllers[3]+a.calls.endpoint.save,e=a.calls.endpoint.methods[1];b.doApiCall(c,d,e,function(b){a.showSuccessMessage=!0,a.closeOverSlider(),a.initData(a.tableData.GD.currentpage)})},a.deleteItemTypes=function(){delete a.editList.list;var c=[];angular.forEach(a.editList,function(a,b){c.push(b)});var d={userId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",sessionId:"169055BD-24D6-4E10-9F98-D4A8C6E102C5",browserInfo:"chrome canary",ids:c},e=a.calls.endpoint.main+a.calls.controllers[3]+a.calls.endpoint["delete"],f=a.calls.endpoint.methods[1];b.doApiCall(d,e,f,function(b){a.showSuccessMessage=!0,a.closeOverSlider(),a.initData(a.tableData.GD.currentpage)})}}]),barbod.directive("brandOverSlider",function(){return{restrict:"AE",templateUrl:"views/brandOverSlider.tpl.html"}}),barbod.directive("supplierOverSlider",function(){return{restrict:"AE",templateUrl:"views/supplierOverSlider.tpl.html"}}),barbod.directive("itemTypeOverSlider",function(){return{restrict:"AE",templateUrl:"views/itemtypeOverSlider.tpl.html"}}),barbod.directive("itemOverSlider",function(){return{restrict:"AE",templateUrl:"views/itemOverSlider.tpl.html"}}),barbod.directive("brandValidation",function(){return{restrict:"AE",templateUrl:"views/brandValidation.tpl.html"}}),barbod.directive("companyInfo",["APIService","$http",function(a,b){return{restrict:"AE",templateUrl:"views/companyInfo.tpl.html"}}]),barbod.directive("genericTable",["APIService","$http",function(a,b){return{restrict:"AE",templateUrl:"views/genericTable.tpl.html",link:function(a,b,c){a.$parent.showEmptyMessage=!0,a.$parent.NoOfItems=0,a.$parent.showHideValidation=!1,a.updateEditList=function(b){a.$parent.NoOfItems=-1,angular.isUndefined(a.barbod.editList.list)&&(a.barbod.editList.list={}),angular.forEach(a.barbod.editList,function(b,c){a.$parent.NoOfItems++,b===!1&&(delete a.barbod.editList[c],delete a.barbod.editList.list[c],a.$parent.NoOfItems--)});var c=a.tableData.GD.data[b][0].value,d=angular.isDefined(a.barbod.editList[c]),e=angular.isUndefined(a.barbod.editList.list[c]);d&&e&&(a.barbod.editList.list[c]=a.tableData.GD.data[b]),a.$parent.editList=a.barbod.editList,a.$parent.showEmptyMessage="{}"===JSON.stringify(a.barbod.editList.list)},a.clearEditList=function(b){a.barbod.editList[k]=!1,a.updateEditList()},a.editMode=!1,a.requesterRow=0,a.moduleLocalCalls=function(b){a.$parent.adding=!1,a.$parent.deleting=!1,a.$parent.editing=!1,a.$parent[b]=!0},a.configModal=function(){$(".ui.basic.modal.hidden").remove(),$(".ui.basic.modal").modal("show")},a.$parent.overSlider=function(){a.$parent.showHideValidation=!a.$parent.showHideValidation},a.$parent.rowEditMode=function(b){a.overSlider(),a.moduleLocalCalls("adding"),a.$parent.$$childTail.barbod.brand.code=a.tableData.GD.data[b][1].value,a.$parent.$$childTail.barbod.brand.description=a.tableData.GD.data[b][2].value,a.$parent.$$childTail.barbod.brand.active=a.tableData.GD.data[b][3].value,console.log(a)}}}}]),barbod.directive("genericMessage",["APIService","$http",function(a,b){return{restrict:"AE",templateUrl:"views/genericMessage.tpl.html",link:function(a,b,c){}}}]),barbod.factory("APIService",["$http",function(a){return{doApiCall:function(b,c,d,e){var f=a({method:d,url:c,params:b});return f.success(e),f.error(e),f}}}]),barbod.service("LocationService",["$location",function(a){this.go=function(b){return a.path(b)}}]),barbod.factory("AccessService",["$http",function(a){return{accessTypes:function(a){a=a.substr(1);var b=a.split("|"),c=/\(([^)]+)\)/,d={};return angular.forEach(b,function(a,b){var e=c.exec(a),f=e[1],g=a.replace(e[0],"");d[b]={},d[b][g]=f}),d}}}]),barbod.controller("LoginCtrl",["$scope","LocationService","APIService","$http","AccessService",function(a,b,c,d,e){$("body").addClass("in-login-bg"),d.get("calls.json").success(function(b){a.callConfig=b,console.log(a.callConfig)}),a.go=function(a){b.go(a)},a.validation=function(){var b=a.callConfig.endpoint.main+a.callConfig.endpoint.userLogin,d=a.callConfig.endpoint.methods[1],f=a.auth;c.doApiCall(f,b,d,function(b){"true"===b.sessionValid&&(localStorage.setItem("access",JSON.stringify(e.accessTypes(b.access))),a.go("/dashboard"))})}}]),barbod.controller("mainDashboardCtrl",["$scope","$location",function(a,b){return $(".shape").shape(),$(".dropdown").dropdown({transition:"drop"}),a.favModules=4,a.go=function(a){b.path(a)},a.modules={},a.dashboardGenerator=function(){var b=JSON.parse(localStorage.getItem("access").replace("&#x20;","").replace("Usr&#x20;","Usr"));console.log(b),a.accessSeperator(b)},a.accessSeperator=function(b){angular.forEach(b,function(b,c){for(c in b)a.moduleConstructor(c)}),console.log(a.modules)},a.moduleConstructor=function(b){var c={A:{name:"Application",mainIcon:"alarm"},Usr:{name:"User",mainIcon:"alarm"},UsrRol:{name:"User Roles",mainIcon:"alarm"},C:{name:"Company",mainIcon:"alarm"},Br:{name:"Branch",mainIcon:"alarm"},Sc:{name:"System Config",mainIcon:"alarm"},Cus:{name:"Customer",mainIcon:"alarm"},S:{name:"Supplier",mainIcon:"alarm"},B:{name:"Brand",mainIcon:"alarm"},I:{name:"Item",mainIcon:"alarm"},IT:{name:"Item Type",mainIcon:"alarm"},M:{name:"Measurement",mainIcon:"alarm"},MC:{name:"Measurement Conversion",mainIcon:"alarm"},Ing:{name:"Ingredients",mainIcon:"alarm"},PR:{name:"Purchase Request",mainIcon:"alarm"},PO:{name:"Purchase Order",mainIcon:"alarm"},P:{name:"Pullout",mainIcon:"alarm"},JO:{name:"Job Order",mainIcon:"alarm"},BOM:{name:"Bill of Materials",mainIcon:"alarm"},STR:{name:"Stock Transfer",mainIcon:"alarm"},InvAdj:{name:"Inventory Adjustment",mainIcon:"alarm"},Inv:{name:"Inventory",mainIcon:"alarm"},InvMov:{name:"Inventory Movement",mainIcon:"alarm"},POS:{name:"Point-of-Sale",mainIcon:"alarm"},POSD:{name:"Point-of-Sale Diner",mainIcon:"alarm"},SO:{name:"Sales Order",mainIcon:"alarm"},SI:{name:"Sales Invoice",mainIcon:"alarm"},SR:{name:"Sales Return",mainIcon:"alarm"}};a.modules[b]={icon:c[b].mainIcon,name:c[b].name,subAccess:[{icon:c[b].mainIcon,name:"add"},{icon:c[b].mainIcon,name:"edit"},{icon:c[b].mainIcon,name:"delete"}]},console.log(a.modules),localStorage.setItem("structedAccess",JSON.stringify(a.modules))},{restrict:"AE",templateUrl:"scripts/dashboard/main-dashboard.tpl.html"}}]);